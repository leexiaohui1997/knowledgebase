# 文档管理应用 - 功能详解

## 🎯 核心功能

### 1️⃣ 知识库列表页面

#### 界面布局
- **顶部导航栏**
  - 标题：📚 知识库管理
  - 搜索框：实时搜索知识库
  - 创建按钮：➕ 创建知识库

- **主体内容区**
  - 网格布局展示知识库卡片
  - 每个卡片包含：
    - 大号表情头像
    - 知识库名称
    - 简介描述
    - 更新时间
    - 删除按钮（悬停显示）

#### 交互功能
✅ **创建知识库**
- 点击「➕ 创建知识库」打开弹窗
- 表单字段：
  - 名称（必填）
  - 头像（20 个表情可选）
  - 简介（可选）
- 实时保存到本地

✅ **搜索知识库**
- 输入关键词即时过滤
- 支持搜索名称和简介
- 空结果时显示友好提示

✅ **进入知识库**
- 点击卡片进入详情页
- 自动加载文档数据

✅ **删除知识库**
- 悬停显示删除图标
- 二次确认防止误删
- 级联删除所有文档

✅ **空状态提示**
- 首次使用时显示引导文字
- 搜索无结果时显示提示

---

### 2️⃣ 知识库详情页面

#### 界面布局
- **顶部导航栏**
  - 返回按钮：← 返回
  - 知识库信息：头像 + 名称
  - 新建按钮：➕ 新建

- **主体分栏布局**
  - 左侧：文档目录（280px 宽）
  - 右侧：Markdown 编辑器（自适应）

#### 左侧 - 文档目录树

✅ **树形结构展示**
- 文件夹：📁（折叠）/ 📂（展开）
- 文件：📄
- 缩进显示层级关系
- 自动排序：文件夹在前，按名称排序

✅ **交互功能**
- 点击文件夹：展开/折叠
- 点击文件：在编辑器中打开
- 悬停显示操作按钮：
  - ➕ 添加子项（仅文件夹）
  - 🗑️ 删除
- 当前选中文件高亮显示

✅ **新建文档节点**
- 支持创建文件和文件夹
- 可在根目录或文件夹内创建
- 即时更新树形结构

✅ **删除文档节点**
- 二次确认
- 文件夹删除会提示级联删除
- 自动递归删除所有子节点

✅ **空状态提示**
- 无文档时显示引导文字

#### 右侧 - Markdown 编辑器

✅ **编辑模式**
- 基于 CodeMirror 6
- 语法高亮
- 自动缩进
- 占位符提示
- 全高度编辑区

✅ **预览模式**
- 基于 markdown-it 渲染
- 美观的样式
- 支持所有标准 Markdown 语法：
  - 标题（H1-H6）
  - 列表（有序/无序）
  - 代码块（行内/块级）
  - 引用
  - 链接和图片
  - 表格
  - 分隔线

✅ **编辑器功能**
- 切换按钮：✏️ 编辑 / 👁️ 预览
- 保存按钮：💾 保存
- 快捷键：Cmd/Ctrl + S
- 实时保存到本地
- 自动同步内容

✅ **未选择文档状态**
- 显示友好的空状态
- 引导用户选择文件

---

## 🔧 技术实现

### 数据流程

```
用户操作
    ↓
Vue 组件（emit 事件）
    ↓
Pinia Store（调用方法）
    ↓
Electron IPC（invoke）
    ↓
主进程处理器（ipc-handlers）
    ↓
本地存储（storage）
    ↓
data.json 文件
```

### 数据结构

#### 知识库（KnowledgeBase）
```typescript
{
  id: string           // 唯一标识
  name: string         // 名称
  avatar: string       // 表情头像
  description: string  // 简介
  createdAt: number    // 创建时间戳
  updatedAt: number    // 更新时间戳
}
```

#### 文档节点（DocumentNode）
```typescript
{
  id: string                    // 唯一标识
  name: string                  // 名称
  type: 'file' | 'folder'       // 类型
  content?: string              // 内容（仅文件）
  parentId: string | null       // 父节点 ID
  knowledgeBaseId: string       // 所属知识库
  children?: DocumentNode[]     // 子节点（仅文件夹）
  createdAt: number             // 创建时间戳
  updatedAt: number             // 更新时间戳
}
```

### 状态管理

使用 Pinia 管理全局状态：
- `knowledgeBases`: 所有知识库
- `currentKnowledgeBase`: 当前知识库
- `documents`: 当前知识库的所有文档
- `currentDocument`: 当前打开的文档

### 路由结构

```
/ (home)
  → KnowledgeBaseList 知识库列表

/knowledge-base/:id
  → KnowledgeBaseDetail 知识库详情
```

使用 Hash 模式（适合 Electron）

---

## 🎨 UI/UX 设计

### 设计原则
- **简洁明了**：去除多余装饰，突出核心功能
- **符号化**：使用表情符号代替图标，更加友好
- **即时反馈**：所有操作立即响应
- **防误操作**：重要操作二次确认

### 颜色方案
- 主题色：`#42b883`（Vue 绿）
- 背景色：`#f5f5f5`（浅灰）
- 文字色：`#333`（深灰）
- 边框色：`#e0e0e0`（中灰）

### 交互细节
- 卡片悬停：上浮 + 阴影 + 边框变色
- 按钮悬停：背景色加深
- 列表项悬停：背景色变化 + 显示操作按钮
- 当前选中：绿色背景 + 加粗文字
- 平滑过渡：所有交互都有 0.2s 过渡动画

### 响应式
- 知识库列表：网格自动适应（最小 320px）
- 详情页：固定左侧宽度 280px，右侧自适应
- 弹窗：最大 90vw，居中显示

---

## 📊 数据持久化

### 存储方式
- 使用 Electron 的 userData 目录
- 单个 JSON 文件存储所有数据
- 同步读写，保证数据一致性

### 存储位置
- **macOS**: `~/Library/Application Support/vite-vue3-electron-demo/data.json`
- **Windows**: `%APPDATA%\vite-vue3-electron-demo\data.json`
- **Linux**: `~/.config/vite-vue3-electron-demo/data.json`

### 数据格式
```json
{
  "knowledgeBases": [
    {
      "id": "1234567890",
      "name": "前端开发笔记",
      "avatar": "📚",
      "description": "记录前端开发学习笔记",
      "createdAt": 1696147200000,
      "updatedAt": 1696147200000
    }
  ],
  "documents": [
    {
      "id": "1234567891",
      "name": "Vue3 基础",
      "type": "file",
      "content": "# Vue3 基础\n\n...",
      "parentId": null,
      "knowledgeBaseId": "1234567890",
      "createdAt": 1696147200000,
      "updatedAt": 1696147200000
    }
  ]
}
```

---

## 🔐 安全性

### Electron 安全配置
- ✅ `nodeIntegration: false` - 禁用 Node 集成
- ✅ `contextIsolation: true` - 启用上下文隔离
- ✅ 使用 preload 脚本暴露有限 API
- ✅ 所有 IPC 通信通过 contextBridge

### 数据安全
- 所有数据存储在本地
- 不涉及网络传输
- 用户完全控制数据

---

## ⚡ 性能优化

### 前端优化
- 使用 Composition API，更好的代码组织
- 计算属性缓存（computed）
- 条件渲染（v-if / v-show）
- 列表 key 优化

### 渲染优化
- CodeMirror 虚拟滚动
- 树形结构按需展开
- 预览模式懒加载

### 构建优化
- Vite 快速热重载
- TypeScript 类型检查
- Tree-shaking 自动优化

---

## 🎯 使用场景

### 适合人群
- 程序员：记录技术笔记
- 学生：整理学习资料
- 写作者：组织文章草稿
- 研究者：管理研究资料

### 应用场景
1. **个人知识库**：系统化管理知识
2. **项目文档**：记录项目相关信息
3. **学习笔记**：按科目分类整理
4. **工作日志**：日常工作记录
5. **创作工具**：写作和草稿管理

---

## 💡 最佳实践

### 组织建议
1. 一个主题一个知识库
2. 使用文件夹分类
3. 文件命名要描述性
4. 不要嵌套太深

### 编写建议
1. 使用 Markdown 标准语法
2. 合理使用标题层级
3. 添加代码示例
4. 定期整理更新

### 维护建议
1. 定期备份 data.json
2. 删除过时内容
3. 保持结构清晰
4. 适时重组分类

---

## 🚀 未来展望

这是一个 MVP（最小可行产品）版本，后续可以扩展：

- 文档重命名和移动
- 拖拽排序
- 全文搜索
- 图片上传
- 导出功能
- 主题切换
- 云同步
- 多窗口编辑
- 协作功能
- 版本历史

---

**享受高效的文档管理体验！** 📚✨

